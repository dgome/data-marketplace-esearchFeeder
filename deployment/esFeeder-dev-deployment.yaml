---
apiVersion: apps/v1 
kind: Deployment
metadata:
  name: esearchfeeder-deployment
spec:
  selector:
    matchLabels:
      app: esearchfeeder
  replicas: 1
  template:
    metadata:
      labels:
        app: esearchfeeder
    spec:
      volumes:
      - name: bookmarkvolume
        persistentVolumeClaim:
          claimName: esfeeder-pvc
      containers:
      - name: esearchfeeder
        image: lgsvl/data-marketplace-esearchfeeder:dev
        imagePullPolicy: Always
        env:
        - name: INDEX_TIMES
          value: "{\"DataContractType\":300}"
        - name: INDEX_PATHS
          value: "{\"DataContractType\":\"api/queries/getDataContractTypesAfterTimeStamp\"}"
        - name: ELASTIC_SEARCH_URL
          value: http://elasticsearch:9200
        - name: CHAINCODE_REST_URL
          value: http://chaincode-rest-service:9090
        - name: AUTHORIZATION
          valueFrom:
            secretKeyRef:
              name: mytoken
              key: AUTHORIZATION #create 
        volumeMounts:      
        - name: bookmarkvolume
          mountPath: /var/run/esfeeder